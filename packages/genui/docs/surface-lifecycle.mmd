sequenceDiagram
    participant LLM as External LLM
    participant Controller as GenUiController
    participant Processor as A2uiMessageProcessor
    participant UI as GenUiSurface (Manager)

    Note over Processor: Policy: keepLatest

    LLM->>Controller: "createSurface(id: 'A')"
    Controller->>Processor: CreateSurface('A')
    Processor->>UI: SurfaceAdded('A')
    UI->>UI: Render Surface A

    LLM->>Controller: "updateComponents(id: 'A', ...)"
    Controller->>Processor: UpdateComponents('A')
    Processor->>UI: ComponentsUpdated('A')
    UI->>UI: Update Surface A

    LLM->>Controller: "createSurface(id: 'B')"
    Controller->>Processor: CreateSurface('B')

    rect rgb(255, 240, 240)
        Note right of Processor: Policy Enforcement
        Processor->>UI: SurfaceRemoved('A')
        UI->>UI: Dispose Surface A
    end

    Processor->>UI: SurfaceAdded('B')
    UI->>UI: Render Surface B