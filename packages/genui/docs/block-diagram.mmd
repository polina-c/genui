graph TD
    subgraph "User"
        UserInput("Provide Prompt")
        UserInteraction("Interact with UI")
    end

    subgraph "GenUI Framework"
        GenUiConversation("GenUiConversation")
        Transport("A2uiTransportAdapter")
        GenUiController("GenUiController")
        Transformer("A2uiParserTransformer")
        GenUiSurface("GenUiSurface")
    end

    UserInput -- "calls sendRequest()" --> GenUiConversation;
    GenUiConversation -- "delegates to" --> Transport;
    Transport -- "calls callback" --> ExternalLLM[External LLM];
    ExternalLLM -- "returns chunks" --> Transport;
    Transport -- "pipes to" --> Transformer;
    Transformer -- "parses events" --> Transport;
    Transport -- "forwards messages" --> GenUiConversation;
    GenUiConversation -- "forwards to" --> GenUiController;
    GenUiController -- "updates state" --> GenUiSurface;
    GenUiSurface -- "renders UI" --> UserInteraction;
    UserInteraction -- "creates event" --> GenUiController;
    GenUiController -- "emits client event" --> GenUiConversation;
    GenUiConversation -- "loops back" --> Transport;